# OpenMemory Vendoring 与补丁管理

本文档说明 OpenMemory 上游镜像的引入方式、补丁分级与升级/回滚策略。

---

## 1. 引入策略

- **默认**：使用上游镜像 `OPENMEMORY_IMAGE`（见 `.env.example`）
- **可选**：自建镜像仓库并锁定版本
- **不建议**：直接在仓库中 vendoring 上游源码（除非有强监管需求）

---

## 2. 补丁分级

| 等级 | 说明 | 示例 |
|------|------|------|
| L0 | 配置变更 | 环境变量、镜像 tag |
| L1 | 非侵入脚本 | 健康检查、启动包装脚本 |
| L2 | 轻量补丁 | 参数校验、可选字段兼容 |
| L3 | 深度改造 | 核心逻辑、存储结构 |

---

## 3. Freeze 与回滚

- **Freeze**：升级窗口内冻结上游版本，避免并发变更
- **回滚**：保持可回滚的上一稳定镜像 tag

---

## Appendix A: Category B 补丁的最小可上游 PR 划分

> 目标：将非侵入补丁拆分为最小可上游的 PR，降低长期维护成本。

- 只包含一个主题（功能/修复/文档）
- 避免跨多个子系统的耦合改动
- 附带回归测试或最小复现脚本

---

更新时间：2026-01-31
