## 最小门禁命令块

<!-- AUTO-GENERATED BY render_min_gate_block.py -->

> **Iteration 13** - 完整 CI 门禁（make ci）
>
> 此段落由脚本自动生成：`python scripts/iteration/render_min_gate_block.py 13 --profile full`

### 命令表格

| 序号 | 检查项 | 命令 | 通过标准 |
|------|--------|------|----------|
| 1 | 代码风格检查 | `make lint` | 退出码 0 |
| 2 | 格式检查 | `make format-check` | 退出码 0 |
| 3 | mypy 类型检查 | `make typecheck` | 退出码 0 |
| 4 | JSON Schema 校验 | `make check-schemas` | 退出码 0 |
| 5 | 环境变量一致性检查 | `make check-env-consistency` | 退出码 0 |
| 6 | Logbook 配置一致性检查 | `make check-logbook-consistency` | 退出码 0 |
| 7 | SQL 迁移文件检查 | `make check-migration-sanity` | 退出码 0 |
| 8 | SCM Sync 一致性检查 | `make check-scm-sync-consistency` | 退出码 0 |
| 9 | Gateway ErrorReason 使用规范检查 | `make check-gateway-error-reason-usage` | 退出码 0 |
| 10 | Gateway Public API 导入表面检查 | `make check-gateway-public-api-surface` | 退出码 0 |
| 11 | Gateway Public API 文档同步检查 | `make check-gateway-public-api-docs-sync` | 退出码 0 |
| 12 | Gateway DI 边界检查 | `make check-gateway-di-boundaries` | 退出码 0 |
| 13 | Gateway 懒加载策略检查 | `make check-gateway-import-surface` | 退出码 0 |
| 14 | Gateway correlation_id 单一来源检查 | `make check-gateway-correlation-id-single-source` | 退出码 0 |
| 15 | 迭代文档规范检查 | `make check-iteration-docs` | 退出码 0 |
| 16 | Workflow 合约校验 | `make validate-workflows-strict` | 退出码 0 |
| 17 | Workflow 合约文档同步检查 | `make check-workflow-contract-docs-sync` | 退出码 0 |
| 18 | Workflow 合约版本策略检查 | `make check-workflow-contract-version-policy` | 退出码 0 |
| 19 | MCP 错误码合约检查 | `make check-mcp-error-contract` | 退出码 0 |
| 20 | MCP 错误码文档同步检查 | `make check-mcp-error-docs-sync` | 退出码 0 |

### 一键执行

```bash
# 一键运行所有门禁（需全部通过）
make lint && \
  make format-check && \
  make typecheck && \
  make check-schemas && \
  make check-env-consistency && \
  make check-logbook-consistency && \
  make check-migration-sanity && \
  make check-scm-sync-consistency && \
  make check-gateway-error-reason-usage && \
  make check-gateway-public-api-surface && \
  make check-gateway-public-api-docs-sync && \
  make check-gateway-di-boundaries && \
  make check-gateway-import-surface && \
  make check-gateway-correlation-id-single-source && \
  make check-iteration-docs && \
  make validate-workflows-strict && \
  make check-workflow-contract-docs-sync && \
  make check-workflow-contract-version-policy && \
  make check-mcp-error-contract && \
  make check-mcp-error-docs-sync
```

### 通过标准

**通过标准**：每个命令需满足对应的通过条件。

- `make lint` → 退出码 0
- `make format-check` → 退出码 0
- `make typecheck` → 退出码 0
- `make check-schemas` → 退出码 0
- `make check-env-consistency` → 退出码 0
- `make check-logbook-consistency` → 退出码 0
- `make check-migration-sanity` → 退出码 0
- `make check-scm-sync-consistency` → 退出码 0
- `make check-gateway-error-reason-usage` → 退出码 0
- `make check-gateway-public-api-surface` → 退出码 0
- `make check-gateway-public-api-docs-sync` → 退出码 0
- `make check-gateway-di-boundaries` → 退出码 0
- `make check-gateway-import-surface` → 退出码 0
- `make check-gateway-correlation-id-single-source` → 退出码 0
- `make check-iteration-docs` → 退出码 0
- `make validate-workflows-strict` → 退出码 0
- `make check-workflow-contract-docs-sync` → 退出码 0
- `make check-workflow-contract-version-policy` → 退出码 0
- `make check-mcp-error-contract` → 退出码 0
- `make check-mcp-error-docs-sync` → 退出码 0
